<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:loc="clr-namespace:LocalizationResourceManager.Maui;assembly=LocalizationResourceManager.Maui"
             xmlns:vm="clr-namespace:Linguibuddy.ViewModels"
             x:Class="Linguibuddy.Views.FlashcardsPage"
             x:DataType="vm:FlashcardsViewModel"
             Title="{Binding Collection.Name}">

    <Grid>
        <VerticalStackLayout IsVisible="{Binding IsFinished}"
                             VerticalOptions="Center"
                             HorizontalOptions="Center"
                             Spacing="25">

            <Label Text="{loc:Translate Congratulations}"
                   FontSize="32"
                   FontAttributes="Bold"
                   TextColor="{AppThemeBinding Light={StaticResource PrimaryDarkText}, Dark={StaticResource White}}"
                   HorizontalOptions="Center" />

            <Label Text="{loc:Translate LearningFinished}"
                   FontSize="16"
                   TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray400}}"
                   HorizontalOptions="Center" />

            <Button Text="{loc:Translate BackToList}"
                    Command="{Binding GoBackCommand}"
                    Margin="0,20,0,0"
                    BackgroundColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                    TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource PrimaryDarkText}}"
                    WidthRequest="200" />
        </VerticalStackLayout>

        <Grid RowDefinitions="*, Auto" IsVisible="{Binding IsLearning}" Margin="20">

            <VerticalStackLayout VerticalOptions="Center" Spacing="0">
                <Border x:Name="FlashcardBorder"
                        Stroke="Transparent"
                        BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray950}}"
                        HeightRequest="420"
                        WidthRequest="320"
                        StrokeShape="RoundRectangle 20">

                    <Border.Shadow>
                        <Shadow Brush="{AppThemeBinding Light={StaticResource Black}, Dark={StaticResource White}}"
                                Offset="0,5" Radius="15" Opacity="0.1" />
                    </Border.Shadow>

                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnCardTapped" Command="{Binding RevealAnswerCommand}" />
                    </Border.GestureRecognizers>

                    <Grid Padding="30">
                        <VerticalStackLayout x:Name="FrontView"
                                             VerticalOptions="Center"
                                             HorizontalOptions="Center"
                                             Spacing="15"
                                             IsVisible="True">

                            <Label Text="{Binding CurrentWordText}"
                                   FontSize="36"
                                   FontAttributes="Bold"
                                   HorizontalTextAlignment="Center"
                                   TextColor="{AppThemeBinding Light={StaticResource Black}, Dark={StaticResource White}}" />

                            <Label Text="{Binding CurrentPhonetic}"
                                   FontSize="14"
                                   HorizontalTextAlignment="Center"
                                   TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray400}}" />

                            <Label Text="{loc:Translate TapToFlip}"
                                   FontSize="12"
                                   Margin="0,40,0,0"
                                   HorizontalTextAlignment="Center"
                                   TextColor="{StaticResource Gray300}" />
                        </VerticalStackLayout>

                        <VerticalStackLayout x:Name="BackView"
                                             VerticalOptions="Center"
                                             HorizontalOptions="Center"
                                             Spacing="15"
                                             IsVisible="False">

                            <Label Text="{Binding CurrentTranslation}"
                                   FontSize="28"
                                   FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                                   HorizontalTextAlignment="Center" />

                            <BoxView HeightRequest="1" WidthRequest="50" Color="{StaticResource Gray200}" />

                            <Label Text="{Binding CurrentDefinition}"
                                   FontSize="14"
                                   TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray300}}"
                                   HorizontalTextAlignment="Center" />

                            <Label Text="{Binding CurrentExample}"
                                   FontSize="14"
                                   FontAttributes="Italic"
                                   TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray400}}"
                                   HorizontalTextAlignment="Center" />
                        </VerticalStackLayout>
                    </Grid>
                </Border>
            </VerticalStackLayout>


            <VerticalStackLayout Grid.Row="1" Spacing="15" Margin="0,0,0,20">

                <Grid IsVisible="{Binding IsAnswerRevealed}">

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="15" IsVisible="{Binding IsStandardMode}"
                          Padding="10"
                          HorizontalOptions="Fill">
                        <Button Grid.Column="0"
                                Text="{loc:Translate IDontKnow}"
                                BackgroundColor="{AppThemeBinding Light=#FFEBEE, Dark=#3E2723}"
                                TextColor="#D32F2F"
                                Command="{Binding MarkAsUnknownCommand}"
                                Clicked="OnNextCardClicked"
                                HorizontalOptions="Fill"
                                MaximumWidthRequest="200"
                                HeightRequest="50" CornerRadius="20">
                            <Button.Shadow>
                                <Shadow
                                    Brush="{AppThemeBinding Light=#FF8097, Dark=#80544D}"
                                    Radius="5"
                                    Opacity="0.4"
                                    Offset="0,4" />
                            </Button.Shadow>
                        </Button>

                        <Button Grid.Column="1"
                                Text="{loc:Translate IKnow}"
                                BackgroundColor="{AppThemeBinding Light=#E8F5E9, Dark=#1B5E20}"
                                TextColor="{AppThemeBinding Light=#2E7D32, Dark=White}"
                                Command="{Binding MarkAsKnownCommand}"
                                Clicked="OnNextCardClicked"
                                HorizontalOptions="Fill"
                                MaximumWidthRequest="200"
                                HeightRequest="50" CornerRadius="20">
                            <Button.Shadow>
                                <Shadow
                                    Brush="{AppThemeBinding Light=#71C17D, Dark=#2E9E34}"
                                    Radius="5"
                                    Opacity="0.4"
                                    Offset="0,4" />
                            </Button.Shadow>
                        </Button>
                    </Grid>

                    <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="20" IsVisible="{Binding IsSrsMode}"
                          Padding="10"
                          HorizontalOptions="Fill">

                        <Button Grid.Column="0"
                                Text="{loc:Translate Srs0}"
                                BackgroundColor="{AppThemeBinding Light=#FFEBEE, Dark=#3E2723}"
                                TextColor="#C62828"
                                FontSize="11"
                                Padding="0"
                                Command="{Binding GradeNullCommand}"
                                Clicked="OnNextCardClicked"
                                MaximumWidthRequest="200"
                                HeightRequest="50" CornerRadius="20">
                            <Button.Shadow>
                                <Shadow
                                    Brush="{AppThemeBinding Light=#FF99AC, Dark=#82524A}"
                                    Radius="5"
                                    Opacity="0.4"
                                    Offset="0,4" />
                            </Button.Shadow>
                        </Button>

                        <Button Grid.Column="1"
                                Text="{loc:Translate Srs2}"
                                BackgroundColor="{AppThemeBinding Light=#FFF3E0, Dark=#573F29}"
                                TextColor="#EF6C00"
                                FontSize="11"
                                Padding="0"
                                Command="{Binding GradeHardCommand}"
                                Clicked="OnNextCardClicked"
                                MaximumWidthRequest="200"
                                HeightRequest="50" CornerRadius="20">
                            <Button.Shadow>
                                <Shadow
                                    Brush="{AppThemeBinding Light=#FFBF66, Dark=#8B6541}"
                                    Radius="5"
                                    Opacity="0.4"
                                    Offset="0,4" />
                            </Button.Shadow>
                        </Button>

                        <Button Grid.Column="2"
                                Text="{loc:Translate Srs4}"
                                BackgroundColor="{AppThemeBinding Light=#E8F5E9, Dark=#193E19}"
                                TextColor="#45BA4B"
                                FontSize="11"
                                Padding="0"
                                Command="{Binding GradeGoodCommand}"
                                Clicked="OnNextCardClicked"
                                MaximumWidthRequest="200"
                                HeightRequest="50" CornerRadius="20">
                            <Button.Shadow>
                                <Shadow
                                    Brush="{AppThemeBinding Light=#97CE97, Dark=#2C6D2C}"
                                    Radius="5"
                                    Opacity="0.4"
                                    Offset="0,4" />
                            </Button.Shadow>
                        </Button>

                        <Button Grid.Column="3"
                                Text="{loc:Translate Srs5}"
                                BackgroundColor="{AppThemeBinding Light=#E3F2FD, Dark=#072A5F}"
                                TextColor="#4794EB"
                                FontSize="11"
                                Padding="0"
                                Command="{Binding GradeEasyCommand}"
                                Clicked="OnNextCardClicked"
                                MaximumWidthRequest="200"
                                HeightRequest="50" CornerRadius="20">
                            <Button.Shadow>
                                <Shadow
                                    Brush="{AppThemeBinding Light=#6CC3F9, Dark=#1255BA}"
                                    Radius="5"
                                    Opacity="0.4"
                                    Offset="0,4" />
                            </Button.Shadow>
                        </Button>
                    </Grid>

                </Grid>
            </VerticalStackLayout>
        </Grid>
    </Grid>
</ContentPage>